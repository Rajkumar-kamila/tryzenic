{"id":38112,"date":"2024-02-01T12:15:38","date_gmt":"2024-02-01T11:15:38","guid":{"rendered":"https:\/\/citronnoir.com\/?p=38112"},"modified":"2024-02-12T19:02:59","modified_gmt":"2024-02-12T18:02:59","slug":"oxygen-template-avec-meta-box","status":"publish","type":"post","link":"https:\/\/citronnoir.com\/snippet-wordpress\/oxygen-template-avec-meta-box\/","title":{"rendered":"S\u00e9lection du template Oxygen builder avec Meta Box"},"content":{"rendered":"\n<h2 class=\"wp-block-heading has-text-align-center\">Code personnalis\u00e9<\/h2>\n\n\n\n<p class=\"has-text-align-center\">Conseil : Ajouter ce code personnalis\u00e9 \u00e0 l'aide du plugin Code Snippet<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>\/\/ Synchroniser la s\u00e9lection du template Oxygen dans la metabox Metabox\nadd_filter( 'rwmb_meta_boxes', 'cn_register_oxygen_templates_dropdown' );\nfunction cn_register_oxygen_templates_dropdown( $meta_boxes ) {\n    $meta_boxes&#91;] = array(\n        'title'      => 'Changer de Template - Citron Noir',\n        'post_types' => 'page',  \/\/ Modifier si n\u00e9cessaire\n        'fields'     => array(\n            array(\n                'id'          => 'oxygen_template',\n                'name'        => 'Template Oxygen',\n                'type'        => 'select',\n                'options'     => cn_get_oxygen_templates(),\n                'std'         => cn_get_current_oxygen_template(),\n            ),\n        ),\n    );\n\n    return $meta_boxes;\n}\n\nfunction cn_get_current_oxygen_template() {\n    global $post;\n    \/\/ Utiliser la cl\u00e9 'ct_other_template' pour lire la s\u00e9lection actuelle\n    $current_template = get_post_meta( $post->ID, 'ct_other_template', true );\n    return $current_template ? $current_template : '';\n}\n\nfunction cn_get_oxygen_templates() {\n    $options = array(\n        '' => 'Site par d\u00e9faut', \/\/ Cette option permet de respecter le comportement par d\u00e9faut d'Oxygen lors de la cr\u00e9ation d'une nouvelle page\n    );\n    $args = array(\n        'post_type'      => 'ct_template',\n        'posts_per_page' => -1,\n    );\n    $templates = get_posts($args);\n    foreach ($templates as $template) {\n        $options&#91;$template->ID] = $template->post_title;\n    }\n    return $options;\n}\n\nadd_action( 'save_post', 'cn_apply_oxygen_template_selection' );\nfunction cn_apply_oxygen_template_selection( $post_id ) {\n    if (defined('DOING_AUTOSAVE') &amp;&amp; DOING_AUTOSAVE)\n        return;\n\n    \/\/ V\u00e9rifiez si 'Site Default' est s\u00e9lectionn\u00e9 et ignorez si c'est le cas\n    if (isset($_POST&#91;'oxygen_template']) &amp;&amp; $_POST&#91;'oxygen_template'] !== '') {\n        \/\/ Mettre \u00e0 jour la m\u00e9tadonn\u00e9e 'ct_other_template' avec la nouvelle s\u00e9lection\n        update_post_meta($post_id, 'ct_other_template', $_POST&#91;'oxygen_template']);\n    }\n}<\/code><\/pre>\n\n\n\n<h2 class=\"wp-block-heading\">Explications du snippet : Synchroniser le choix du template d'Oxygen Builder avec Meta Box<\/h2>\n\n\n\n<p><br>Ce Snippet permet la <strong>synchronisation dynamique des templates Oxygen<\/strong> au sein d'une liste d\u00e9roulante personnalis\u00e9e Metabox, offrant aux utilisateurs la possibilit\u00e9 de s\u00e9lectionner et d'appliquer diff\u00e9rents templates Oxygen aux pages directement depuis l'administration WordPress.<\/p>\n\n\n\n<ul class=\"wp-block-list\">\n<li>La fonction <code>register_oxygen_templates_dropdown<\/code> : Ajoute une liste d\u00e9roulante Metabox personnalis\u00e9e dans l'administration WordPress pour la s\u00e9lection des templates Oxygen, pr\u00e9-remplie avec le template actuel et une liste de tous les templates Oxygen disponibles.<\/li>\n\n\n\n<li>La fonction <code>get_current_oxygen_template<\/code> : R\u00e9cup\u00e8re le template Oxygen actuellement appliqu\u00e9 au post, assurant que la liste d\u00e9roulante Metabox refl\u00e8te avec pr\u00e9cision l'\u00e9tat actuel du post.<\/li>\n\n\n\n<li>La fonction <code>get_oxygen_templates<\/code> : Compile une liste de tous les templates Oxygen disponibles, fournissant les donn\u00e9es n\u00e9cessaires pour remplir la liste d\u00e9roulante Metabox.<\/li>\n\n\n\n<li>La fonction <code>apply_oxygen_template_selection<\/code> : Met \u00e0 jour le template Oxygen du post en fonction de la s\u00e9lection de l'utilisateur dans la liste d\u00e9roulante Metabox, garantissant que le template choisi est appliqu\u00e9 au post.<\/li>\n<\/ul>\n\n\n\n<p><strong>Remarques :<\/strong><\/p>\n\n\n\n<ul class=\"wp-block-list\">\n<li>L'option \"site par d\u00e9faut\" permet de laisser la priorit\u00e9 du template d'Oxygen Builder lors de la cr\u00e9ation d'une nouvelle page<\/li>\n\n\n\n<li>Il est possible d'ajouter des conditions de type 'allcaps' et 'caps' pour afficher la metabox selon le r\u00f4le de l'utilisateur. OU d'accorder l'acc\u00e8s \u00e0 tous les utilisateurs mais de bloquer l'acc\u00e8s \u00e0 Oxygen builder depuis<em> Oxygen > Settings > Client Controle<\/em><\/li>\n<\/ul>\n","protected":false},"excerpt":{"rendered":"<p>Ce Snippet permet la synchronisation dynamique des templates d'Oxygen Builder avec Metabox, permettant aux utilisateurs de s\u00e9lectionner et d'appliquer les templates Oxygen depuis une liste Metabox.<br \/>\nCela est particuli\u00e8rement utile pour laisser la possibilit\u00e9 au r\u00f4le \"editeur\" de choisir le template, sans acc\u00e9der \u00e0 Oxygen Builder.<\/p>\n","protected":false},"author":4,"featured_media":38154,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_seopress_robots_primary_cat":"none","_seopress_titles_title":"S\u00e9lection du template Oxygen builder avec Meta Box","_seopress_titles_desc":"Ce Snippet permet la synchronisation dynamique des templates Oxygen au sein d&#039;une liste d\u00e9roulante personnalis\u00e9e Metabox.","_seopress_robots_index":"","footnotes":""},"categories":[200],"tags":[],"class_list":["post-38112","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","category-snippet-wordpress"],"_links":{"self":[{"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/posts\/38112"}],"collection":[{"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/users\/4"}],"replies":[{"embeddable":true,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/comments?post=38112"}],"version-history":[{"count":17,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/posts\/38112\/revisions"}],"predecessor-version":[{"id":38187,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/posts\/38112\/revisions\/38187"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/media\/38154"}],"wp:attachment":[{"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/media?parent=38112"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/categories?post=38112"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/citronnoir.com\/wp-json\/wp\/v2\/tags?post=38112"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}